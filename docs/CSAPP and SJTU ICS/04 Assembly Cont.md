---
sidebar_position: 1
---

这篇笔记包含lectre8-10的内容，介绍了jmp指令、汇编中的函数和数组（等数据结构）。

## 条件码

### EFLAGS寄存器

这个寄存器用于存储相应控制信息。  

- CF（Carry Flag）：在无符号运算中，结果超出了运算范围置1，反之置0。

- OF（Overflow Flag）：在有符号运算中发生溢出，置1，反之置0。

- ZF（Zero Flag）：如果结果为0置为1，反之置0。

- SF（Sign Flag）：与符号位相同，即正数为0，负数为1。  

### 设置与读取条件码

各种算数操作会隐式设置条件码。在加法运算时，四种条件码都会对应设置。异或指令会将CF和OF设为0，移位操作会将CF设置为最后移出的位、OF设置为0，lea对条件码没有影响。  

条件码还可以通过比较来显示设置。对于指令 ``cmp a, b`` ，类似于计算 ``b - a`` 但不进行存储。如果最高有效位进位，设置CF；如果 ``a == b`` ，设置ZF；如果 ``a > b`` ，设置SF；如果出现溢出，即 ``(a > 0 && b < 0 && (a - b) < 0) || (a < 0 && b > 0 && (a - b) > 0)`` ，设置OF。  

``test`` 指令也可以设置条件码，相当于计算 ``a & b`` 。同样地，如果 ``a & b == 0`` ，ZF置为1；如果 ``a & b < 0`` ，SF置为1。  

条件码无法直接读取。要读取条件码，需要基于条件码向寄存器或内存中设置值。  

![accessing conditional codes](./img/accessing%20conditional%20codes.png)  

注意目标位置必须是单字节寄存器或单字节内存。如果要将条件码存储在32/64位的位置，必须将目标位置的高位置0。

```x86asm
cmpq %rsi, %rdi
setl %al
movzbl %al, %eax
```